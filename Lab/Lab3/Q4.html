<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Tasmania Web GIS — OpenLayers + WMS (Carriageways, Cadastre, Bus Trips)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v10.6.1/ol.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.css" />
<style>
:root { --pad: 12px; }
body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
header { padding: var(--pad); border-bottom: 1px solid #e5e5e5; display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
#map { width: 100%; height: calc(100vh - 92px); }
.toolbar { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
input, select, button, label { font: inherit; }
.credit { font-size: 12px; color:#666; }
.panel { padding: 6px 10px; background:#fff; border:1px solid #ddd; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.06); }
</style>
</head>
<body>
<header>
<div>
<h3 style="margin:0;">Tasmania Web GIS — OpenLayers</h3>
<div class="credit">Base map: Azure Maps or OSM · Overlays: Tasmania GeoServer WMS</div>
</div>
<div class="toolbar">
<div class="panel">
<label for="azureKey">Azure Maps key:</label>
<input id="azureKey" type="text" size="36" placeholder="Optional — paste to enable Azure basemap" />
<button id="useAzure">Use Azure</button>
</div>
<div class="panel">
<label for="opacityCar">Carriageways</label>
<input id="opacityCar" type="range" min="0" max="1" step="0.05" value="1" />
<label for="opacityCad">Cadastre</label>
<input id="opacityCad" type="range" min="0" max="1" step="0.05" value="0.6" />
<label for="opacityBus">Bus Trips</label>
<input id="opacityBus" type="range" min="0" max="1" step="0.05" value="1" />
</div>
</div>
</header>


<div id="map" class="map"></div>


<script src="https://cdn.jsdelivr.net/npm/ol@v10.6.1/dist/ol.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.2/dist/ol-layerswitcher.js"></script>
<script>
// --- Constants & helpers ---
const wmsUrl = 'https://data.stategrowth.tas.gov.au/geoserver/ows';


// Tasmania rough extent (lon/lat, EPSG:4326). Buffer added.
const tasExtent4326 = [144.0, -44.2, 149.0, -39.0];
const tasExtent3857 = ol.proj.transformExtent(tasExtent4326, 'EPSG:4326', 'EPSG:3857');


function azureXYZ(tilesetId, key) {
return new ol.source.XYZ({
url: `https://atlas.microsoft.com/map/tile?api-version=2.1&tilesetId=${tilesetId}&zoom={z}&x={x}&y={y}&tileSize=256&view=Auto&subscription-key=${encodeURIComponent(key)}`,
attributions: '© Microsoft Azure Maps',
crossOrigin: 'anonymous'
});
}


// --- Basemaps ---
const osm = new ol.layer.Tile({
title: 'OpenStreetMap',
type: 'base',
visible: true,
source: new ol.source.OSM()
});


const azureRoad = new ol.layer.Tile({
title: 'Azure Maps — Road',
type: 'base',
visible: false,
source: null // will be set when a key is provided
});


</html>
